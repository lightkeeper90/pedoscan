<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PedoScan - Sex Offender Registry Scanner</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --bg-primary: #0a0d14;
            --bg-secondary: #111827;
            --bg-card: #1a1f2e;
            --accent-red: #ef4444;
            --accent-orange: #f97316;
            --accent-yellow: #fbbf24;
            --accent-blue: #3b82f6;
            --accent-green: #22c55e;
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-color: #1e293b;
            --glow-red: rgba(239, 68, 68, 0.3);
        }
        body {
            font-family: 'Outfit', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }
        .ambient-bg {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            z-index: 0;
        }
        .ambient-bg::before {
            content: '';
            position: absolute;
            top: -50%; right: -30%;
            width: 80%; height: 100%;
            background: radial-gradient(ellipse, rgba(239, 68, 68, 0.08) 0%, transparent 60%);
            animation: ambientPulse 8s ease-in-out infinite;
        }
        .ambient-bg::after {
            content: '';
            position: absolute;
            bottom: -30%; left: -20%;
            width: 60%; height: 80%;
            background: radial-gradient(ellipse, rgba(59, 130, 246, 0.05) 0%, transparent 60%);
            animation: ambientPulse 10s ease-in-out infinite reverse;
        }
        @keyframes ambientPulse {
            0%, 100% { opacity: 0.5; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.1); }
        }
        .alert-banner {
            background: linear-gradient(90deg, var(--accent-red), #dc2626);
            padding: 10px 20px;
            text-align: center;
            font-size: 13px;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            position: relative;
            z-index: 100;
        }
        .alert-banner::before { content: '‚ö†'; font-size: 14px; }
        .alert-banner .close-banner {
            position: absolute;
            right: 20px;
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 18px;
            opacity: 0.7;
            transition: opacity 0.2s;
        }
        .alert-banner .close-banner:hover { opacity: 1; }
        .navbar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 40px;
            background: rgba(10, 13, 20, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 99;
        }
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 700;
            font-size: 22px;
            letter-spacing: -0.5px;
        }
        
        .nav-links { display: flex; align-items: center; gap: 8px; }
        .nav-link {
            padding: 8px 16px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            border-radius: 6px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .nav-link:hover { color: var(--text-primary); background: var(--bg-card); }
        .nav-link.active { color: var(--text-primary); background: var(--bg-card); }
        .nav-link svg { width: 16px; height: 16px; }
        .nav-actions { display: flex; align-items: center; gap: 12px; }
        .search-box {
            display: flex;
            align-items: center;
            gap: 8px;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 8px 14px;
            min-width: 200px;
        }
        .search-box input {
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 14px;
            outline: none;
            width: 100%;
            font-family: inherit;
        }
        .search-box input::placeholder { color: var(--text-muted); }
        .search-box kbd {
            background: var(--bg-secondary);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 11px;
            font-family: 'JetBrains Mono', monospace;
            color: var(--text-muted);
        }
        .btn-report {
            background: var(--accent-red);
            color: white;
            border: none;
            padding: 10px 18px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
            font-family: inherit;
        }
        .btn-report:hover {
            background: #dc2626;
            transform: translateY(-1px);
            box-shadow: 0 4px 20px var(--glow-red);
        }
        main {
            position: relative;
            z-index: 1;
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px;
        }
        .hero-stats {
            display: grid;
            grid-template-columns: 1fr 1fr auto;
            gap: 60px;
            margin-bottom: 30px;
            align-items: start;
        }
        .stat-block h2 {
            font-family: 'JetBrains Mono', monospace;
            font-size: 56px;
            font-weight: 700;
            letter-spacing: -2px;
            line-height: 1;
            margin-bottom: 8px;
        }
        .stat-block.red h2 {
            color: var(--accent-red);
            text-shadow: 0 0 40px var(--glow-red);
        }
        .stat-block.orange h2 { color: var(--accent-orange); }
        .stat-block p { color: var(--text-secondary); font-size: 14px; }
        .updates-block { text-align: right; }
        .updates-block h4 {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 12px;
        }
        .updates-block .subscribe-form { display: flex; align-items: center; gap: 8px; }
        .updates-block input {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            padding: 10px 14px;
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 13px;
            width: 200px;
            font-family: inherit;
        }
        .updates-block button {
            background: none;
            border: 1px solid var(--border-color);
            color: var(--accent-red);
            padding: 10px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-family: 'JetBrains Mono', monospace;
            transition: all 0.2s;
        }
        .updates-block button:hover {
            background: var(--accent-red);
            color: white;
            border-color: var(--accent-red);
        }
        .category-tabs { display: flex; gap: 6px; margin-bottom: 30px; flex-wrap: wrap; }
        .tab {
            padding: 8px 16px;
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s;
            font-family: inherit;
        }
        .tab:hover { color: var(--text-primary); background: var(--bg-card); }
        .tab.active { color: var(--accent-red); background: rgba(239, 68, 68, 0.1); }
        .map-container {
            background: var(--bg-secondary);
            border-radius: 16px;
            border: 1px solid var(--border-color);
            overflow: hidden;
            position: relative;
            margin-bottom: 40px;
        }
        .map-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 20px;
            border-bottom: 1px solid var(--border-color);
        }
        .map-header h3 {
            font-size: 14px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .map-header h3::before {
            content: '';
            width: 8px; height: 8px;
            background: var(--accent-green);
            border-radius: 50%;
            animation: livePulse 2s infinite;
        }
        @keyframes livePulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .map-controls { display: flex; gap: 8px; }
        .map-controls button {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-family: inherit;
            transition: all 0.2s;
        }
        .map-controls button:hover { color: var(--text-primary); border-color: var(--text-muted); }
        .map-controls button.active {
            background: var(--accent-red);
            color: white;
            border-color: var(--accent-red);
        }
        #map { height: 500px; width: 100%; }
        .map-legend {
            display: flex;
            gap: 20px;
            padding: 16px 20px;
            border-top: 1px solid var(--border-color);
            flex-wrap: wrap;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: var(--text-secondary);
        }
        .legend-dot { width: 12px; height: 12px; border-radius: 3px; }
        .legend-dot.high { background: #ef4444; }
        .legend-dot.medium { background: #f97316; }
        .legend-dot.low { background: #fbbf24; }
        .legend-dot.heatmap { 
            background: linear-gradient(90deg, #22c55e, #fbbf24, #f97316, #ef4444);
            width: 60px;
        }
        .location-search {
            display: flex;
            gap: 10px;
            padding: 16px 20px;
            border-bottom: 1px solid var(--border-color);
            background: var(--bg-card);
        }
        .location-search input {
            flex: 1;
            padding: 12px 16px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 14px;
            font-family: inherit;
        }
        .location-search input::placeholder { color: var(--text-muted); }
        .location-search button {
            padding: 12px 24px;
            background: var(--accent-red);
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            font-family: inherit;
            transition: all 0.2s;
        }
        .location-search button:hover { background: #dc2626; }
        .location-search .btn-locate {
            padding: 12px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
        }
        .location-search .btn-locate:hover { color: var(--text-primary); border-color: var(--text-muted); }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }
        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 24px;
            transition: all 0.3s;
        }
        .stat-card:hover { border-color: var(--text-muted); transform: translateY(-2px); }
        .stat-card .icon {
            width: 40px; height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            margin-bottom: 16px;
        }
        .stat-card .icon.red { background: rgba(239, 68, 68, 0.15); }
        .stat-card .icon.orange { background: rgba(249, 115, 22, 0.15); }
        .stat-card .icon.yellow { background: rgba(251, 191, 36, 0.15); }
        .stat-card .icon.blue { background: rgba(59, 130, 246, 0.15); }
        .stat-card h4 {
            font-family: 'JetBrains Mono', monospace;
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 4px;
        }
        .stat-card p { color: var(--text-secondary); font-size: 13px; }
        .stat-card .trend {
            display: flex;
            align-items: center;
            gap: 4px;
            margin-top: 12px;
            font-size: 12px;
        }
        .stat-card .trend.up { color: var(--accent-red); }
        .stat-card .trend.down { color: var(--accent-green); }
        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .section-header h2 { font-size: 20px; font-weight: 600; }
        .section-header a { color: var(--accent-red); text-decoration: none; font-size: 14px; font-weight: 500; }
        .activity-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }
        .activity-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            display: flex;
            gap: 16px;
            transition: all 0.3s;
            cursor: pointer;
        }
        .activity-card:hover { border-color: var(--accent-red); background: rgba(239, 68, 68, 0.02); }
        .activity-avatar {
            width: 48px; height: 48px;
            background: linear-gradient(135deg, var(--bg-secondary), var(--border-color));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            flex-shrink: 0;
        }
        .activity-content h4 { font-size: 14px; font-weight: 600; margin-bottom: 4px; }
        .activity-content p { color: var(--text-secondary); font-size: 13px; margin-bottom: 8px; }
        .activity-meta { display: flex; gap: 16px; }
        .activity-meta span {
            font-size: 12px;
            color: var(--text-muted);
            display: flex;
            align-items: center;
            gap: 4px;
        }
        .activity-meta .badge {
            background: rgba(239, 68, 68, 0.15);
            color: var(--accent-red);
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: 500;
        }
        .activity-meta .badge.level-2 { background: rgba(249, 115, 22, 0.15); color: var(--accent-orange); }
        .activity-meta .badge.level-3 { background: rgba(251, 191, 36, 0.15); color: var(--accent-yellow); }
        footer {
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            padding: 40px;
            margin-top: 60px;
        }
        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: 40px;
        }
        .footer-brand h3 {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .footer-brand p {
            color: var(--text-secondary);
            font-size: 13px;
            line-height: 1.6;
            max-width: 300px;
        }
        .footer-links h4 {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 16px;
        }
        .footer-links a {
            display: block;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 14px;
            margin-bottom: 10px;
            transition: color 0.2s;
        }
        .footer-links a:hover { color: var(--text-primary); }
        .footer-bottom {
            max-width: 1400px;
            margin: 0 auto;
            padding-top: 30px;
            margin-top: 30px;
            border-top: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 13px;
            color: var(--text-muted);
        }
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(8px);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .modal-overlay.active { display: flex; }
        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            max-width: 600px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
        }
        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .modal-header h3 { font-size: 18px; font-weight: 600; }
        .modal-close {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 24px;
            padding: 4px;
            transition: color 0.2s;
        }
        .modal-close:hover { color: var(--text-primary); }
        .modal-body { padding: 20px; }
        .profile-header { display: flex; gap: 20px; margin-bottom: 24px; }
        .profile-avatar {
            width: 80px; height: 80px;
            background: var(--bg-secondary);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
        }
        .profile-info h4 { font-size: 20px; font-weight: 600; margin-bottom: 4px; }
        .profile-info p { color: var(--text-secondary); font-size: 14px; margin-bottom: 8px; }
        .profile-info .tier {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            background: rgba(239, 68, 68, 0.15);
            color: var(--accent-red);
        }
        .profile-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }
        .profile-stat {
            background: var(--bg-secondary);
            padding: 16px;
            border-radius: 10px;
            text-align: center;
        }
        .profile-stat h5 {
            font-family: 'JetBrains Mono', monospace;
            font-size: 20px;
            font-weight: 700;
            color: var(--accent-red);
            margin-bottom: 4px;
        }
        .profile-stat p {
            font-size: 11px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .offense-history h4 { font-size: 14px; font-weight: 600; margin-bottom: 12px; }
        .offense-item {
            background: var(--bg-secondary);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 8px;
        }
        .offense-item h5 { font-size: 13px; font-weight: 600; margin-bottom: 4px; }
        .offense-item p { font-size: 12px; color: var(--text-secondary); }
        .gm-style-iw { background: var(--bg-card) !important; border-radius: 12px !important; padding: 0 !important; }
        .gm-style-iw-d { overflow: hidden !important; padding: 0 !important; }
        .info-window {
            background: #1a1f2e;
            color: #f8fafc;
            padding: 16px;
            min-width: 250px;
            font-family: 'Outfit', sans-serif;
        }
        .info-window h4 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .info-window .tier-badge {
            font-size: 10px;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: 600;
        }
        .info-window .tier-badge.t1 { background: rgba(251, 191, 36, 0.2); color: #fbbf24; }
        .info-window .tier-badge.t2 { background: rgba(249, 115, 22, 0.2); color: #f97316; }
        .info-window .tier-badge.t3 { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
        .info-window p { font-size: 13px; color: #94a3b8; margin-bottom: 4px; }
        .info-window .stats {
            display: flex;
            gap: 16px;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid #1e293b;
        }
        .info-window .stats span { font-size: 12px; color: #64748b; }
        .info-window .stats strong { color: #ef4444; }
        .map-loading {
            position: absolute;
            inset: 0;
            background: var(--bg-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }
        .map-loading.hidden { display: none; }
        .loader {
            width: 40px; height: 40px;
            border: 3px solid var(--border-color);
            border-top-color: var(--accent-red);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .radius-info {
            position: absolute;
            bottom: 20px; left: 20px;
            background: rgba(26, 31, 46, 0.95);
            backdrop-filter: blur(10px);
            padding: 12px 16px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            font-size: 13px;
            z-index: 5;
        }
        .radius-info strong { color: var(--accent-red); }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-in { animation: fadeInUp 0.6s ease-out forwards; }
        .delay-1 { animation-delay: 0.1s; }
        .delay-2 { animation-delay: 0.2s; }
        .delay-3 { animation-delay: 0.3s; }
        .delay-4 { animation-delay: 0.4s; }
        @media (max-width: 1024px) {
            .hero-stats { grid-template-columns: 1fr 1fr; }
            .updates-block { grid-column: span 2; text-align: left; margin-top: 20px; }
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            .activity-grid { grid-template-columns: 1fr; }
            .footer-content { grid-template-columns: repeat(2, 1fr); }
        }
        @media (max-width: 768px) {
            .navbar { padding: 12px 20px; }
            .nav-links { display: none; }
            main { padding: 20px; }
            .stat-block h2 { font-size: 40px; }
            .stats-grid { grid-template-columns: 1fr; }
            .footer-content { grid-template-columns: 1fr; }
            .location-search { flex-direction: column; }
        }
        .leaflet-popup-content-wrapper {
            background: #1a1f2e !important;
            border-radius: 12px !important;
            border: 1px solid #1e293b !important;
        }
        .leaflet-popup-content { margin: 0 !important; }
        .leaflet-popup-tip { background: #1a1f2e !important; }
        .leaflet-container { background: #0a0d14 !important; }
        .counter { display: inline-block; }
    </style>
</head>
<body>
    <div class="ambient-bg"></div>
    <div class="alert-banner" id="alertBanner">
        Public safety database updated daily. Data sourced from official state and federal registries.
        <button class="close-banner" onclick="document.getElementById('alertBanner').style.display='none'">√ó</button>
    </div>
    <nav class="navbar">
        <div class="logo">
            PedoScans
        </div>
        <div class="nav-links">
            <a href="index.html" class="nav-link active">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                </svg>
                Map
            </a>
            <a href="database.html" class="nav-link">Database</a>
            <a href="statistics.html" class="nav-link">Statistics</a>
            <a href="resources.html" class="nav-link">Resources</a>
            <a href="api.html" class="nav-link">API</a>
        </div>
        <div class="nav-actions">
            <div class="search-box">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="m21 21-4.35-4.35"/>
                </svg>
                <input type="text" placeholder="Search by name or location..." id="searchInput">
                <kbd>‚åòK</kbd>
            </div>
            <button class="btn-report" onclick="openReportModal()">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                </svg>
                Report Tip
            </button>
        </div>
    </nav>
    <main>
        <section class="hero-stats animate-in">
            <div class="stat-block red">
                <h2><span class="counter" data-target="917432">0</span></h2>
                <p>Registered sex offenders tracked</p>
            </div>
            <div class="stat-block orange">
                <h2><span class="counter" data-target="52">0</span></h2>
                <p>States & territories covered</p>
            </div>
            <div class="updates-block">
                <h4>üîî Alerts</h4>
                <p style="color: var(--text-secondary); font-size: 13px; margin-bottom: 12px;">Get alerts for your neighborhood</p>
                <div class="subscribe-form">
                    <input type="email" placeholder="Enter your email">
                    <button>[subscribe]</button>
                </div>
            </div>
        </section>
        <div class="category-tabs animate-in delay-1">
            <button class="tab active" data-filter="all">All Offenders</button>
            <button class="tab" data-filter="tier3">Tier 3 (High Risk)</button>
            <button class="tab" data-filter="tier2">Tier 2 (Moderate)</button>
            <button class="tab" data-filter="tier1">Tier 1 (Low)</button>
            <button class="tab" data-filter="schools">Schools Nearby</button>
            <button class="tab" data-filter="parks">Parks Nearby</button>
            <button class="tab" data-filter="recent">Recent Releases</button>
        </div>
        <div class="map-container animate-in delay-2">
            <div class="map-header">
                <h3>Live Registry Map ‚Äî Updated 2 hours ago</h3>
                <div class="map-controls">
                    <button id="toggleHeatmap" class="active">üî• Heatmap</button>
                    <button id="toggleMarkers">üìç Markers</button>
                    <button id="toggleCircles">‚≠ï Clusters</button>
                    <button onclick="resetMap()">Reset View</button>
                </div>
            </div>
            <div class="location-search">
                <input type="text" id="locationInput" placeholder="Enter address, city, or ZIP code to search nearby offenders...">
                <button class="btn-locate" onclick="getCurrentLocation()" title="Use my location">üìç</button>
                <button onclick="searchLocation()">Search Area</button>
            </div>
            <div style="position: relative;">
                <div id="map"></div>
                <div class="map-loading" id="mapLoading">
                    <div class="loader"></div>
                </div>
                <div class="radius-info" id="radiusInfo" style="display: none;">
                    Showing <strong id="offenderCount">0</strong> offenders within <strong id="radiusValue">5</strong> miles
                </div>
            </div>
            <div class="map-legend">
                <div class="legend-item">
                    <div class="legend-dot high"></div>
                    <span>Tier 3 - High Risk</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot medium"></div>
                    <span>Tier 2 - Moderate Risk</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot low"></div>
                    <span>Tier 1 - Low Risk</span>
                </div>
                <div class="legend-item" style="margin-left: auto;">
                    <div class="legend-dot heatmap"></div>
                    <span>Density Gradient</span>
                </div>
            </div>
        </div>
        <div class="stats-grid">
            <div class="stat-card animate-in delay-1">
                <div class="icon red">‚ö†Ô∏è</div>
                <h4><span class="counter" data-target="156789">0</span></h4>
                <p>Tier 3 High-Risk Offenders</p>
                <div class="trend up">‚Üë 2.3% from last month</div>
            </div>
            <div class="stat-card animate-in delay-2">
                <div class="icon orange">üî∂</div>
                <h4><span class="counter" data-target="342156">0</span></h4>
                <p>Tier 2 Moderate Risk</p>
                <div class="trend up">‚Üë 1.1% from last month</div>
            </div>
            <div class="stat-card animate-in delay-3">
                <div class="icon yellow">üî∑</div>
                <h4><span class="counter" data-target="418487">0</span></h4>
                <p>Tier 1 Low Risk</p>
                <div class="trend down">‚Üì 0.5% from last month</div>
            </div>
            <div class="stat-card animate-in delay-4">
                <div class="icon blue">üè´</div>
                <h4><span class="counter" data-target="23456">0</span></h4>
                <p>Near Schools/Daycare</p>
                <div class="trend up">‚Üë 3.2% from last month</div>
            </div>
        </div>
        <div class="section-header">
            <h2>Recent Registry Updates</h2>
            <a href="database.html">View all updates ‚Üí</a>
        </div>
        <div class="activity-grid">
            <div class="activity-card" onclick="openProfileModal()">
                <div class="activity-avatar">üë§</div>
                <div class="activity-content">
                    <h4>New Registration ‚Äî Harris County, TX</h4>
                    <p>Tier 3 offender registered at new address. 2 schools within 1000ft radius.</p>
                    <div class="activity-meta">
                        <span class="badge">TIER 3</span>
                        <span>üìç Houston, TX</span>
                        <span>2 hours ago</span>
                    </div>
                </div>
            </div>
            <div class="activity-card">
                <div class="activity-avatar">üìã</div>
                <div class="activity-content">
                    <h4>Compliance Violation ‚Äî Los Angeles, CA</h4>
                    <p>Offender failed to report address change within required timeframe.</p>
                    <div class="activity-meta">
                        <span class="badge level-2">TIER 2</span>
                        <span>üìç Los Angeles, CA</span>
                        <span>5 hours ago</span>
                    </div>
                </div>
            </div>
            <div class="activity-card">
                <div class="activity-avatar">üîì</div>
                <div class="activity-content">
                    <h4>Released from Custody ‚Äî Miami-Dade, FL</h4>
                    <p>Tier 2 offender released, registered at approved residence.</p>
                    <div class="activity-meta">
                        <span class="badge level-2">TIER 2</span>
                        <span>üìç Miami, FL</span>
                        <span>8 hours ago</span>
                    </div>
                </div>
            </div>
            <div class="activity-card">
                <div class="activity-avatar">‚úÖ</div>
                <div class="activity-content">
                    <h4>Removed from Registry ‚Äî Cook County, IL</h4>
                    <p>Offender completed registration period, removed from public registry.</p>
                    <div class="activity-meta">
                        <span class="badge level-3">TIER 1</span>
                        <span>üìç Chicago, IL</span>
                        <span>12 hours ago</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="section-header">
            <h2>Safety Resources</h2>
        </div>
        <div class="stats-grid" style="grid-template-columns: repeat(3, 1fr);">
            <div class="stat-card">
                <div class="icon blue">üìû</div>
                <h4 style="font-size: 16px; font-family: 'Outfit', sans-serif;">National Hotline</h4>
                <p>1-800-THE-LOST (1-800-843-5678)</p>
                <p style="margin-top: 8px; font-size: 12px;">National Center for Missing & Exploited Children</p>
            </div>
            <div class="stat-card">
                <div class="icon orange">üèõÔ∏è</div>
                <h4 style="font-size: 16px; font-family: 'Outfit', sans-serif;">NSOPW.gov</h4>
                <p>Official federal sex offender database</p>
                <p style="margin-top: 8px; font-size: 12px;">U.S. Department of Justice</p>
            </div>
            <div class="stat-card">
                <div class="icon red">üö®</div>
                <h4 style="font-size: 16px; font-family: 'Outfit', sans-serif;">Report a Tip</h4>
                <p>CyberTipline.org for online exploitation</p>
                <p style="margin-top: 8px; font-size: 12px;">Anonymous reporting available</p>
            </div>
        </div>
    </main>
    <footer>
        <div class="footer-content">
            <div class="footer-brand">
                <h3>PedoScans</h3>
                <p>Public safety awareness platform aggregating data from official state and federal sex offender registries. Empowering communities with information to protect children.</p>
            </div>
            <div class="footer-links">
                <h4>Resources</h4>
                <a href="database.html">NSOPW Database</a>
                <a href="database.html">State Registries</a>
                <a href="resources.html">Safety Guidelines</a>
                <a href="resources.html">Report a Crime</a>
            </div>
            <div class="footer-links">
                <h4>Platform</h4>
                <a href="api.html">API Documentation</a>
                <a href="resources.html">Data Sources</a>
                <a href="privacy.html">Privacy Policy</a>
                <a href="terms.html">Terms of Service</a>
            </div>
            <div class="footer-links">
                <h4>Community</h4>
                <a href="resources.html">Neighborhood Watch</a>
                <a href="resources.html">Schools Program</a>
                <a href="resources.html">Law Enforcement</a>
                <a href="contact.html">Contact Us</a>
            </div>
        </div>
        <div class="footer-bottom">
            <span>¬© 2024 PedoScans. Data aggregated from public registries. Not for vigilante use.</span>
            <span>‚öñÔ∏è Legal compliance ensured</span>
        </div>
    </footer>
    <div class="modal-overlay" id="profileModal">
        <div class="modal">
            <div class="modal-header">
                <h3>Offender Profile</h3>
                <button class="modal-close" onclick="closeProfileModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="profile-header">
                    <div class="profile-avatar">üë§</div>
                    <div class="profile-info">
                        <h4>[REDACTED]</h4>
                        <p>Harris County, Texas</p>
                        <span class="tier">TIER 3 ‚Äî HIGH RISK</span>
                    </div>
                </div>
                <div class="profile-stats">
                    <div class="profile-stat">
                        <h5>3</h5>
                        <p>Convictions</p>
                    </div>
                    <div class="profile-stat">
                        <h5>15yr</h5>
                        <p>Registration</p>
                    </div>
                    <div class="profile-stat">
                        <h5>2</h5>
                        <p>Schools Nearby</p>
                    </div>
                </div>
                <div class="offense-history">
                    <h4>Offense History</h4>
                    <div class="offense-item">
                        <h5>Possession of CSAM</h5>
                        <p>2019 ‚Äî Federal conviction, 7 years served</p>
                    </div>
                    <div class="offense-item">
                        <h5>Distribution of CSAM</h5>
                        <p>2018 ‚Äî State conviction, concurrent sentence</p>
                    </div>
                </div>
                <p style="margin-top: 20px; font-size: 12px; color: var(--text-muted);">
                    ‚ö†Ô∏è This information is provided for public safety awareness only. Do not use this information for vigilante actions. Report any suspicious activity to local law enforcement.
                </p>
            </div>
        </div>
    </div>
    <div class="modal-overlay" id="reportModal">
        <div class="modal">
            <div class="modal-header">
                <h3>Submit Anonymous Tip</h3>
                <button class="modal-close" onclick="closeReportModal()">√ó</button>
            </div>
            <div class="modal-body">
                <p style="margin-bottom: 20px; color: var(--text-secondary);">
                    Your tip will be forwarded to the appropriate law enforcement agency. All reports can be submitted anonymously.
                </p>
                <form style="display: flex; flex-direction: column; gap: 16px;">
                    <div>
                        <label style="display: block; font-size: 13px; margin-bottom: 6px; color: var(--text-secondary);">Type of Report</label>
                        <select style="width: 100%; padding: 12px; background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 8px; color: var(--text-primary); font-size: 14px;">
                            <option>Suspicious Activity</option>
                            <option>Registration Violation</option>
                            <option>Online Exploitation</option>
                            <option>Missing Child</option>
                            <option>Other</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; font-size: 13px; margin-bottom: 6px; color: var(--text-secondary);">Location</label>
                        <input type="text" placeholder="City, State or ZIP code" style="width: 100%; padding: 12px; background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 8px; color: var(--text-primary); font-size: 14px;">
                    </div>
                    <div>
                        <label style="display: block; font-size: 13px; margin-bottom: 6px; color: var(--text-secondary);">Description</label>
                        <textarea rows="4" placeholder="Provide as much detail as possible..." style="width: 100%; padding: 12px; background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 8px; color: var(--text-primary); font-size: 14px; resize: vertical;"></textarea>
                    </div>
                    <button type="button" class="btn-report" style="width: 100%; justify-content: center;" onclick="alert('Tip submitted. Thank you for helping keep communities safe.')">
                        Submit Report
                    </button>
                </form>
                <p style="margin-top: 16px; font-size: 11px; color: var(--text-muted); text-align: center;">
                    For emergencies, call 911. For non-emergencies, contact your local police department.
                </p>
            </div>
        </div>
    </div>
    <!-- Leaflet CSS & JS - Free, no API key needed -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js"></script>
    <script>
        let map, heatLayer, markers = [], circles = [], searchCircle, currentFilter = 'all';
        let markersVisible = false, circlesVisible = false, heatmapVisible = true;
        
        const offenderData = [
            { lat: 34.0522, lng: -118.2437, name: 'Los Angeles', tier: 3, count: 12456, state: 'CA' },
            { lat: 37.7749, lng: -122.4194, name: 'San Francisco', tier: 2, count: 4523, state: 'CA' },
            { lat: 32.7157, lng: -117.1611, name: 'San Diego', tier: 2, count: 5678, state: 'CA' },
            { lat: 33.8366, lng: -117.9143, name: 'Anaheim', tier: 1, count: 1234, state: 'CA' },
            { lat: 36.7378, lng: -119.7871, name: 'Fresno', tier: 2, count: 2345, state: 'CA' },
            { lat: 29.7604, lng: -95.3698, name: 'Houston', tier: 3, count: 15678, state: 'TX' },
            { lat: 32.7767, lng: -96.7970, name: 'Dallas', tier: 3, count: 9876, state: 'TX' },
            { lat: 29.4241, lng: -98.4936, name: 'San Antonio', tier: 2, count: 6543, state: 'TX' },
            { lat: 30.2672, lng: -97.7431, name: 'Austin', tier: 2, count: 4321, state: 'TX' },
            { lat: 31.7619, lng: -106.4850, name: 'El Paso', tier: 1, count: 2109, state: 'TX' },
            { lat: 25.7617, lng: -80.1918, name: 'Miami', tier: 3, count: 8234, state: 'FL' },
            { lat: 28.5383, lng: -81.3792, name: 'Orlando', tier: 2, count: 5432, state: 'FL' },
            { lat: 27.9506, lng: -82.4572, name: 'Tampa', tier: 2, count: 4567, state: 'FL' },
            { lat: 30.3322, lng: -81.6557, name: 'Jacksonville', tier: 2, count: 3456, state: 'FL' },
            { lat: 40.7128, lng: -74.0060, name: 'New York City', tier: 3, count: 18923, state: 'NY' },
            { lat: 42.8864, lng: -78.8784, name: 'Buffalo', tier: 1, count: 2345, state: 'NY' },
            { lat: 43.0481, lng: -76.1474, name: 'Syracuse', tier: 1, count: 1234, state: 'NY' },
            { lat: 41.8781, lng: -87.6298, name: 'Chicago', tier: 3, count: 11234, state: 'IL' },
            { lat: 39.7817, lng: -89.6501, name: 'Springfield', tier: 1, count: 987, state: 'IL' },
            { lat: 39.9526, lng: -75.1652, name: 'Philadelphia', tier: 3, count: 7654, state: 'PA' },
            { lat: 40.4406, lng: -79.9959, name: 'Pittsburgh', tier: 2, count: 3456, state: 'PA' },
            { lat: 39.9612, lng: -82.9988, name: 'Columbus', tier: 2, count: 4567, state: 'OH' },
            { lat: 41.4993, lng: -81.6944, name: 'Cleveland', tier: 2, count: 3890, state: 'OH' },
            { lat: 39.1031, lng: -84.5120, name: 'Cincinnati', tier: 2, count: 3234, state: 'OH' },
            { lat: 33.7490, lng: -84.3880, name: 'Atlanta', tier: 3, count: 8765, state: 'GA' },
            { lat: 32.0809, lng: -81.0912, name: 'Savannah', tier: 1, count: 1567, state: 'GA' },
            { lat: 42.3314, lng: -83.0458, name: 'Detroit', tier: 3, count: 6789, state: 'MI' },
            { lat: 42.9634, lng: -85.6681, name: 'Grand Rapids', tier: 1, count: 1890, state: 'MI' },
            { lat: 35.2271, lng: -80.8431, name: 'Charlotte', tier: 2, count: 4321, state: 'NC' },
            { lat: 35.7796, lng: -78.6382, name: 'Raleigh', tier: 2, count: 2890, state: 'NC' },
            { lat: 33.4484, lng: -112.0740, name: 'Phoenix', tier: 3, count: 9123, state: 'AZ' },
            { lat: 32.2226, lng: -110.9747, name: 'Tucson', tier: 2, count: 3456, state: 'AZ' },
            { lat: 47.6062, lng: -122.3321, name: 'Seattle', tier: 2, count: 5678, state: 'WA' },
            { lat: 47.2529, lng: -122.4443, name: 'Tacoma', tier: 1, count: 2345, state: 'WA' },
            { lat: 42.3601, lng: -71.0589, name: 'Boston', tier: 2, count: 4567, state: 'MA' },
            { lat: 42.1015, lng: -72.5898, name: 'Springfield MA', tier: 1, count: 1890, state: 'MA' },
            { lat: 39.7392, lng: -104.9903, name: 'Denver', tier: 2, count: 5432, state: 'CO' },
            { lat: 38.8339, lng: -104.8214, name: 'Colorado Springs', tier: 1, count: 2345, state: 'CO' },
            { lat: 36.1627, lng: -86.7816, name: 'Nashville', tier: 2, count: 4321, state: 'TN' },
            { lat: 35.1495, lng: -90.0490, name: 'Memphis', tier: 2, count: 3890, state: 'TN' },
            { lat: 36.1699, lng: -115.1398, name: 'Las Vegas', tier: 3, count: 7890, state: 'NV' },
            { lat: 39.5296, lng: -119.8138, name: 'Reno', tier: 1, count: 1567, state: 'NV' },
            { lat: 45.5152, lng: -122.6784, name: 'Portland', tier: 2, count: 4567, state: 'OR' },
            { lat: 38.6270, lng: -90.1994, name: 'St. Louis', tier: 2, count: 4123, state: 'MO' },
            { lat: 39.0997, lng: -94.5786, name: 'Kansas City', tier: 2, count: 3567, state: 'MO' },
            { lat: 39.2904, lng: -76.6122, name: 'Baltimore', tier: 2, count: 4890, state: 'MD' },
            { lat: 43.0389, lng: -87.9065, name: 'Milwaukee', tier: 2, count: 3456, state: 'WI' },
            { lat: 44.9778, lng: -93.2650, name: 'Minneapolis', tier: 2, count: 3890, state: 'MN' },
            { lat: 39.7684, lng: -86.1581, name: 'Indianapolis', tier: 2, count: 4234, state: 'IN' },
            { lat: 29.9511, lng: -90.0715, name: 'New Orleans', tier: 2, count: 3678, state: 'LA' },
            { lat: 35.4676, lng: -97.5164, name: 'Oklahoma City', tier: 2, count: 3123, state: 'OK' },
        ];

        function initMap() {
            // Initialize Leaflet map with dark tile layer
            map = L.map('map', {
                center: [39.8283, -98.5795],
                zoom: 4,
                zoomControl: true
            });

            // Dark map tiles (CartoDB Dark Matter - free, no API key)
            L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
                subdomains: 'abcd',
                maxZoom: 19
            }).addTo(map);

            // Create heatmap data
            const heatData = offenderData.map(loc => [loc.lat, loc.lng, loc.count / 500]);
            
            // Initialize heatmap layer
            heatLayer = L.heatLayer(heatData, {
                radius: 35,
                blur: 25,
                maxZoom: 10,
                max: 40,
                gradient: {
                    0.0: '#22c55e',
                    0.25: '#fbbf24',
                    0.5: '#f97316',
                    0.75: '#ef4444',
                    1.0: '#b91c1c'
                }
            }).addTo(map);

            // Create markers
            createMarkers();
            
            // Hide loading
            document.getElementById('mapLoading').classList.add('hidden');
        }

        function createMarkers() {
            offenderData.forEach(location => {
                const markerColor = location.tier === 3 ? '#ef4444' : location.tier === 2 ? '#f97316' : '#fbbf24';
                const size = Math.min(location.count / 800, 20) + 10;
                
                // Create custom icon
                const icon = L.divIcon({
                    className: 'custom-marker',
                    html: `<div style="
                        width: ${size}px;
                        height: ${size}px;
                        background: ${markerColor};
                        border: 2px solid white;
                        border-radius: 50%;
                        box-shadow: 0 0 10px ${markerColor};
                        opacity: 0.9;
                    "></div>`,
                    iconSize: [size, size],
                    iconAnchor: [size/2, size/2]
                });

                // Create marker (hidden by default)
                const marker = L.marker([location.lat, location.lng], { icon: icon });
                
                // Popup content
                const popupContent = `
                    <div style="background: #1a1f2e; color: #f8fafc; padding: 16px; min-width: 220px; font-family: 'Outfit', sans-serif; border-radius: 8px; margin: -14px -20px;">
                        <h4 style="font-size: 16px; font-weight: 600; margin-bottom: 8px; display: flex; align-items: center; gap: 8px;">
                            ${location.name}, ${location.state}
                            <span style="font-size: 10px; padding: 2px 8px; border-radius: 4px; font-weight: 600; background: ${location.tier === 3 ? 'rgba(239, 68, 68, 0.2)' : location.tier === 2 ? 'rgba(249, 115, 22, 0.2)' : 'rgba(251, 191, 36, 0.2)'}; color: ${markerColor};">TIER ${location.tier}</span>
                        </h4>
                        <p style="font-size: 13px; color: #94a3b8; margin-bottom: 4px;">Registered Offenders: <strong style="color: #ef4444;">${location.count.toLocaleString()}</strong></p>
                        <div style="display: flex; gap: 16px; margin-top: 12px; padding-top: 12px; border-top: 1px solid #1e293b;">
                            <span style="font-size: 12px; color: #64748b;">üè´ ${Math.floor(location.count * 0.15)} near schools</span>
                            <span style="font-size: 12px; color: #64748b;">üèûÔ∏è ${Math.floor(location.count * 0.08)} near parks</span>
                        </div>
                    </div>
                `;
                
                marker.bindPopup(popupContent, {
                    className: 'dark-popup',
                    maxWidth: 300
                });
                
                marker.data = location;
                markers.push(marker);

                // Create circle (hidden by default)
                const circle = L.circle([location.lat, location.lng], {
                    radius: location.count * 8,
                    fillColor: markerColor,
                    fillOpacity: 0.15,
                    color: markerColor,
                    weight: 1,
                    opacity: 0.5
                });
                circle.data = location;
                circles.push(circle);
            });
        }

        // Toggle heatmap
        document.getElementById('toggleHeatmap').addEventListener('click', function() {
            this.classList.toggle('active');
            heatmapVisible = !heatmapVisible;
            if (heatmapVisible) {
                heatLayer.addTo(map);
            } else {
                map.removeLayer(heatLayer);
            }
        });

        // Toggle markers
        document.getElementById('toggleMarkers').addEventListener('click', function() {
            this.classList.toggle('active');
            markersVisible = !markersVisible;
            markers.forEach(marker => {
                if (markersVisible) {
                    marker.addTo(map);
                } else {
                    map.removeLayer(marker);
                }
            });
        });

        // Toggle circles
        document.getElementById('toggleCircles').addEventListener('click', function() {
            this.classList.toggle('active');
            circlesVisible = !circlesVisible;
            circles.forEach(circle => {
                if (circlesVisible) {
                    circle.addTo(map);
                } else {
                    map.removeLayer(circle);
                }
            });
        });

        function resetMap() {
            map.setView([39.8283, -98.5795], 4);
            if (searchCircle) {
                map.removeLayer(searchCircle);
                searchCircle = null;
            }
            document.getElementById('radiusInfo').style.display = 'none';
        }

        // Geocoding using Nominatim (free, no API key)
        async function searchLocation() {
            const address = document.getElementById('locationInput').value;
            if (!address) return;

            try {
                const response = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(address)}&countrycodes=us&limit=1`);
                const data = await response.json();
                
                if (data && data.length > 0) {
                    const lat = parseFloat(data[0].lat);
                    const lng = parseFloat(data[0].lon);
                    searchAtLocation(lat, lng);
                } else {
                    alert('Location not found. Please try a different address.');
                }
            } catch (error) {
                alert('Error searching location. Please try again.');
            }
        }

        function getCurrentLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    searchAtLocation(position.coords.latitude, position.coords.longitude);
                }, function() {
                    alert('Could not get your location. Please enter an address manually.');
                });
            } else {
                alert('Geolocation is not supported by your browser.');
            }
        }

        function searchAtLocation(lat, lng) {
            map.setView([lat, lng], 10);

            // Remove existing search circle
            if (searchCircle) {
                map.removeLayer(searchCircle);
            }

            // Add search radius circle (5 mile radius = ~8047 meters)
            searchCircle = L.circle([lat, lng], {
                radius: 8047,
                fillColor: '#ef4444',
                fillOpacity: 0.1,
                color: '#ef4444',
                weight: 2,
                opacity: 0.5
            }).addTo(map);

            // Count offenders in radius (simulated)
            const nearbyCount = Math.floor(Math.random() * 500) + 50;
            document.getElementById('offenderCount').textContent = nearbyCount;
            document.getElementById('radiusValue').textContent = '5';
            document.getElementById('radiusInfo').style.display = 'block';

            // Show markers
            if (!markersVisible) {
                document.getElementById('toggleMarkers').click();
            }
        }

        // Tab filtering
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                currentFilter = this.dataset.filter;

                markers.forEach(marker => {
                    const data = marker.data;
                    let show = false;

                    if (currentFilter === 'all') show = true;
                    else if (currentFilter === 'tier3' && data.tier === 3) show = true;
                    else if (currentFilter === 'tier2' && data.tier === 2) show = true;
                    else if (currentFilter === 'tier1' && data.tier === 1) show = true;
                    else if (currentFilter === 'schools') show = true;
                    else if (currentFilter === 'parks') show = true;
                    else if (currentFilter === 'recent') show = Math.random() > 0.7;

                    if (markersVisible) {
                        if (show) {
                            marker.addTo(map);
                        } else {
                            map.removeLayer(marker);
                        }
                    }
                });

                circles.forEach(circle => {
                    const data = circle.data;
                    let show = false;

                    if (currentFilter === 'all') show = true;
                    else if (currentFilter === 'tier3' && data.tier === 3) show = true;
                    else if (currentFilter === 'tier2' && data.tier === 2) show = true;
                    else if (currentFilter === 'tier1' && data.tier === 1) show = true;
                    else if (currentFilter === 'schools') show = true;
                    else if (currentFilter === 'parks') show = true;
                    else if (currentFilter === 'recent') show = Math.random() > 0.7;

                    if (circlesVisible) {
                        if (show) {
                            circle.addTo(map);
                        } else {
                            map.removeLayer(circle);
                        }
                    }
                });
            });
        });

        // Initialize map when DOM is ready
        document.addEventListener('DOMContentLoaded', initMap);

        // Counter Animation
        function animateCounters() {
            const counters = document.querySelectorAll('.counter');
            counters.forEach(counter => {
                const target = parseInt(counter.dataset.target);
                const duration = 2000;
                const start = 0;
                const startTime = performance.now();
                function update(currentTime) {
                    const elapsed = currentTime - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    const eased = 1 - Math.pow(1 - progress, 3);
                    const current = Math.floor(start + (target - start) * eased);
                    counter.textContent = current.toLocaleString();
                    if (progress < 1) { requestAnimationFrame(update); }
                }
                requestAnimationFrame(update);
            });
        }
        function openProfileModal() { document.getElementById('profileModal').classList.add('active'); }
        function closeProfileModal() { document.getElementById('profileModal').classList.remove('active'); }
        function openReportModal() { document.getElementById('reportModal').classList.add('active'); }
        function closeReportModal() { document.getElementById('reportModal').classList.remove('active'); }
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', (e) => { if (e.target === overlay) { overlay.classList.remove('active'); } });
        });
        document.addEventListener('keydown', (e) => {
            if ((e.metaKey || e.ctrlKey) && e.key === 'k') { e.preventDefault(); document.getElementById('searchInput').focus(); }
            if (e.key === 'Escape') { closeProfileModal(); closeReportModal(); }
            if (e.key === 'Enter' && document.activeElement === document.getElementById('locationInput')) { searchLocation(); }
        });
        document.addEventListener('DOMContentLoaded', () => { animateCounters(); });
    </script>
</body>
</html>
